---
description: 
globs: 
alwaysApply: false
---
ì´ì œ ë„ˆëŠ” Kotlin í”„ë¡œ ê°œë°œìì´ë©°, Lantern BLE í…ŒìŠ¤íŠ¸ ì•±ì„ ê¹”ë”í•˜ê³  ìœ ì§€ë³´ìˆ˜ì„± ë†’ê²Œ êµ¬í˜„í•´ì•¼ í•´. ì•„ë˜ **ê¸°ë³¸ ë£°**ì„ ì§€í‚¤ë©´ì„œ, **ë‹¨ê³„ë³„**ë¡œ ê° í´ë˜ìŠ¤Â·ComposableÂ·ViewModel ì½”ë“œë¥¼ ì¶œë ¥í•´ ì¤˜.

---

ğŸ”¹ **[ê³µí†µ ì½”ë”© ë£°]**  
1. Kotlin ìŠ¤íƒ€ì¼ ê°€ì´ë“œ(ë„¤ì´ë°, í¬ë§·)ë¥¼ ì¤€ìˆ˜  
2. SOLID ì›ì¹™ ì ìš©, ì¤‘ë³µ ì œê±°(DRY), ì ì ˆí•œ ì¶”ìƒí™”  
3. KDoc ì£¼ì„ìœ¼ë¡œ public API ë¬¸ì„œí™”  
4. ì˜ˆì™¸ ì²˜ë¦¬Â·ë¡œê¹…Â·ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ í¬í•¨  
5. ê¸°ëŠ¥ë³„ ëª¨ë“ˆí™” (BleManager, UI, ViewModel, Utils, Data)  

---

ğŸ“¦ **[í”„ë¡œì íŠ¸ êµ¬ì¡°]**  
- **BleManager**  
  - BleServiceManager.kt  
  - BlePermissionsManager.kt  
  - BleAdvertiser.kt  
  - BleScanner.kt  
  - BleGattClient.kt  
  - BleGattServer.kt  
- **Utils**  
  - Constants.kt (UUID, ê¶Œí•œ ì½”ë“œ)  
  - DataClasses.kt (ScannedDevice, ChatMessage)  
  - DistanceEstimator.kt (RSSIâ†’ê±°ë¦¬ ê³„ì‚°)  
- **UI** (`jetpack-compose`)  
  - BleStatusSection.kt  
  - DeviceListSection.kt  
  - GattChatSection.kt  
  - AppColors.kt  
- **ViewModel**  
  - BleViewModel.kt  

---

ğŸ›  **[UI/UX & ìƒ‰ìƒ]**  
- ë°°ê²½: `#FFFFFF` ë˜ëŠ” `#F2F2F2`  
- í…ìŠ¤íŠ¸/ì•„ì´ì½˜: `#333333`  
- ì•¡ì…˜ ë²„íŠ¼: ë°°ê²½ `#FFC300` / ì•„ì´ì½˜ `#333333`  
- ìƒíƒœ í‘œì‹œ:  
  - í™œì„±: `#4CAF50`,  
  - ì‹¤íŒ¨: `#F44336`,  
  - ëŒ€ê¸°: `#FFC107`,  
  - ë¹„í™œì„±: `#AAAAAA`  

---

ğŸš€ **[ë‹¨ê³„ë³„ êµ¬í˜„ & ìš”ì²­ ë°©ì‹]**  
ê° ë‹¨ê³„ë§ˆë‹¤ â€œ**íŒŒì¼ëª…**â€ í˜¹ì€ â€œ**í´ë˜ìŠ¤ëª…**â€ê³¼ í•¨ê»˜,  
- í•„ìš”í•œ **í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜**  
- **Compose UI** ë ˆì´ì•„ì›ƒ êµ¬ì¡°(íŒŒë¼ë¯¸í„° í¬í•¨)  
- **ViewModel** í”„ë¡œí¼í‹° & ìƒíƒœíë¦„  
- **ì½”í‹€ë¦° DSL(Gradle)** ì˜ì¡´ì„± ì˜ˆì‹œ  
ë¥¼ ëª…í™•íˆ ëª…ì‹œí•´ì„œ ì½”ë“œ ìŠ¤ë‹ˆí«ì„ ë‹¬ë¼ê³  ìš”ì²­í•´ ì¤˜.

### 1ï¸âƒ£ ë‹¨ê³„ 1: BLE ê¶Œí•œ ë° ì–´ëŒ‘í„° ì´ˆê¸°í™”  
> â€œBleServiceManager.ktâ€  
- `initAdapter(): Boolean`  
- `enableBluetooth(): Flow<Boolean>`  
- `checkPermissions(): Flow<PermissionState>`  
- ì§§ì€ ì˜ˆì œ ì½”ë“œì™€ í•¨ê»˜ KDoc ë‹¬ ê²ƒ.  

### 2ï¸âƒ£ ë‹¨ê³„ 2: ê´‘ê³ (Advertiser) & ìŠ¤ìº”(Scanner) ëª¨ë“ˆ  
> â€œBleAdvertiser.ktâ€, â€œBleScanner.ktâ€  
- `startAdvertising(uuid: UUID): Result<Unit>`  
- `stopAdvertising(): Result<Unit>`  
- `startScan(uuid: UUID): Flow<ScannedDevice>`  
- `stopScan(): Result<Unit>`  
- ì½”ë£¨í‹´ + ì±„ë„ ì‚¬ìš© ì˜ˆì‹œ í¬í•¨  

### 3ï¸âƒ£ ë‹¨ê³„ 3: GATT í´ë¼ì´ì–¸íŠ¸/ì„œë²„  
> â€œBleGattClient.ktâ€, â€œBleGattServer.ktâ€  
- `connectToDevice(device: ScannedDevice): Flow<GattState>`  
- `sendMessage(message: String): Result<Unit>`  
- `receiveMessages(): Flow<ChatMessage>`  
- ì„œë¹„ìŠ¤/ìºë¦­í„°ë¦¬ìŠ¤í‹± íƒìƒ‰ ë° ì˜ˆì™¸ì²˜ë¦¬ ì½”ë“œ  

### 4ï¸âƒ£ ë‹¨ê³„ 4: UI Composables & ViewModel  
> â€œBleStatusSection.ktâ€, â€œDeviceListSection.ktâ€, â€œGattChatSection.ktâ€  
- Compose í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜(ì˜ˆ: `@Composable fun BleStatusSection(state: BleState, onToggleScan: ()->Unit)`)  
- `BleViewModel` ì—ì„œ ìƒíƒœ ê´€ë¦¬ ë° ì´ë²¤íŠ¸ ë©”ì†Œë“œ ì •ì˜  
- ìƒ˜í”Œ Preview ì½”ë“œ  

### 5ï¸âƒ£ ë‹¨ê³„ 5: í…ŒìŠ¤íŠ¸ & ì˜ˆì™¸ ì²˜ë¦¬  
- ê° ëª¨ë“ˆë³„ **JUnit + MockK** í…ŒìŠ¤íŠ¸ ìŠ¤í…  
- `BleServiceManager` ê¶Œí•œ íë¦„ í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ  
- Compose UI snapshot í…ŒìŠ¤íŠ¸ ë°©ë²• ì œì•ˆ  

---

ğŸ” **ì¶”ê°€ ì§ˆë¬¸**  
- UUID ì˜ˆì‹œë‚˜ Android API ë ˆë²¨ ìµœì†Œ ì§€ì› ì •ë³´ë¥¼ ì•Œë ¤ì£¼ì‹œë©´ ë”ìš± ì •í™•í•œ ì½”ë“œë¥¼ ë§Œë“¤ ìˆ˜ ìˆì–´ìš”.  
- BLE í†µì‹  ì‹œ ë³´ì•ˆ(ì•”í˜¸í™”) ëª¨ë“ˆì´ í•„ìš”í•œì§€ë„ ê²€í† ê°€ í•„ìš”í•©ë‹ˆë‹¤.

ì´ í”„ë¡¬í”„íŠ¸ë¥¼ ë°”íƒ•ìœ¼ë¡œ, **íŒŒì¼ë³„Â·ë‹¨ê³„ë³„**ë¡œ ì™„ì„±ë„ ë†’ì€ Kotlin BLE í…ŒìŠ¤íŠ¸ ì•± ì½”ë“œë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ìƒì„±í•´ ì£¼ì„¸ìš”. ê°ì‚¬í•©ë‹ˆë‹¤!
